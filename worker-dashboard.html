<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Worker Dashboard - KIMOJA</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Worker Dashboard</h1>
        <nav>
            <a href="homepage.html">Back to Home</a>
            <button onclick="logout()">Logout</button>
        </nav>
    </header>
    <main>
        <section id="workerSelectSection" class="card">
            <h2>Select Group and Worker</h2>
            <select id="groupSelect"></select>
            <select id="workerSelect"></select>
        </section>
        <section id="headerSection" class="card">
            <h2>Worker Info</h2>
            <p id="workerInfo"></p>
        </section>
        <section id="todaySummary" class="card">
            <h2>Today Summary</h2>
            <p id="todayInfo"></p>
        </section>
        <section id="currentCycle" class="card">
            <h2>Current Cycle</h2>
            <p id="cycleInfo"></p>
        </section>
        <section id="earningsGraphs" class="card">
            <h2>Earnings Graphs</h2>
            <p id="dailyMessage"></p>
            <canvas id="dailyChart"></canvas>
            <p id="cumulativeMessage"></p>
            <canvas id="cumulativeChart"></canvas>
        </section>
        <section id="paymentStatus" class="card">
            <h2>Payment Status</h2>
            <p id="paymentInfo"></p>
        </section>
        <section id="workHistory" class="card">
            <h2>Work History</h2>
            <table id="historyTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Truck Plate</th>
                        <th>Amount Earned</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="historyBody"></tbody>
            </table>
        </section>
        <section id="financialLiteracy" class="card">
            <h2>Financial Tip of the Day</h2>
            <div id="tipContent"></div>
        </section>
    </main>
    <footer>
        <p>&copy; 2024 KIMOJA. All rights reserved.</p>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="logic.js"></script>
    <script>
        let group = 'ELITE';
        const groups = ['ELITE', 'NGORONYO', 'SHERIF', 'SCORPION', 'ACHIEVERS', 'MWEA'];
        const groupSelect = document.getElementById('groupSelect');
        const workerSelect = document.getElementById('workerSelect');
        const user = checkLogin();
        if (user.role === 'worker') {
            group = user.group;
            groupSelect.style.display = 'none';
            workerSelect.style.display = 'none';
            // Populate selects but hide
            groups.forEach(g => {
                const option = document.createElement('option');
                option.value = g;
                option.textContent = g;
                groupSelect.appendChild(option);
            });
            loadData();
            workerSelect.value = user.worker;
            updateDashboard();
        } else {
            // Admin
            groups.forEach(g => {
                const option = document.createElement('option');
                option.value = g;
                option.textContent = g;
                groupSelect.appendChild(option);
            });
            groupSelect.value = group;
            loadData();
            groupSelect.addEventListener('change', () => {
                group = groupSelect.value;
                loadData();
            });
            workerSelect.addEventListener('change', updateDashboard);
        }
    </script>
    <script src="firebase.js"></script>
</body>
</html>